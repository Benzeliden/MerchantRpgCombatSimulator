<!doctype html>
<html class="no-js" lang="">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>MerchantCalc - Combat calculator for mobile game Merchant</title>
    <meta name="description" content="Combat calculator for mobile game Merchant">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--<link rel="stylesheet" href="bundle.css">-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!--[if lt IE 9]>
            <script src="js/vendor/html5-3.6-respond-1.4.2.min.js"></script>
        <![endif]-->
</head>

<body ng-app="myApp">
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

    <div class="header-container">
        <header class="wrapper clearfix">
            <h1 class="title">Merchant calculator</h1>
            <!--
                <nav>
                    <ul>
                        <li><a href="#">nav ul li a</a></li>
                        <li><a href="#">nav ul li a</a></li>
                        <li><a href="#">nav ul li a</a></li>
                    </ul>
                </nav>
                -->
        </header>
    </div>

    <div class="main-container">
        <div class="main wrapper clearfix">

            <article>
                <uib-tabset>
                    <uib-tab heading="Solo mage">
                        <ng-controller ng-controller="soloMageController as smc">
                            <section>
                                <h2>Setup mage stats</h2>
                                <hero-stats-editable hero="smc.mage"></hero-stats-editable>

                            </section>
                            <section>
                                <h2>Pick enemy</h2>
                                <select-enemy on-select="smc.handleEnemySelection($event)" hide-info="!smc.showInfo"></select-enemy>
                            </section>
                            <section>
                                <h2>Pick skills ({{smc.totalAp}} / 20 used):</h2>
                                <skills-picker hero="smc.mage" skills-changed="smc.skillsChanged(skills, totalAp)"></skills-picker>
                            </section>
                            <section ng-if="smc.showInfo">
                                <h2>Simulate</h2>
                                <p>Hit chance: {{smc.getHitChance() | number:0}} %</p>
                                <button ng-click="smc.simulate()">Simulate</button>
                                <div ng-if="smc.showResult">
                                    <h3>{{smc.lastSimResult.resultText}}</h3>
                                    <ul>
                                        <li>
                                            Fight result - {{smc.lastSimResult.resultText}}
                                        </li>
                                        <li>
                                            Hp loss - {{smc.lastSimResult.hpLost}}
                                        </li>
                                        <li>
                                            Damage dealt - <b>{{smc.lastSimResult.heroDeal.pdmg}}</b> atk <b>{{smc.lastSimResult.heroDeal.mdmg}}</b> matk 
                                        </li>
                                        <li>
                                            Fight duration - {{smc.lastSimResult.duration}}
                                        </li>
                                    </ul>
                                </div>
                            </section>
                        </ng-controller>
                    </uib-tab>
                    <uib-tab heading="Setup party stats">

                        <header>
                            <h1>Setup stats</h1>
                            <p>Please setup stats for your heroes</p>
                        </header>
                        <section ng-controller="setupController as set">
                            <h2>Heroes ({{set.heroes.length}} / {{set.maxHeroCount}})</h2>
                            <h3>Click on hero icon to add hero!</h3>

                            <div class="animate-hide" ng-hide="set.heroes.length == set.maxHeroCount">
                                <div class="hero-picker" ng-repeat="class in set.availableHeroes track by class.id" ng-click="set.addHero(class.id)" title="{{class.fullName}}">

                                    <div class="ico-heroes" ng-class="class.icon"></div>
                                </div>
                            </div>

                            <div class="animate-repeat" ng-repeat="hero in set.heroes">
                                <hr/>
                                <div>
                                    <span class="ico-heroes" ng-class="hero.icon"></span>
                                    <span class="v-align-super">{{hero.name}}</span>
                                    <span class="icon-pencil" ng-click="set.editHero(hero)"></span>
                                    <span class="icon-cross" ng-click="set.removeHero(hero.id)"></span>
                                    <hero-stats data="hero"></hero-stats>
                                </div>
                            </div>
                        </section>
                    </uib-tab>
                    <uib-tab heading="Select enemy">
                        <section ng-controller="enemyController as ec">
                            <h2>Explore enemies</h2>
                            <select-enemy on-select="ec.handler($event)" hide-info="ec.hideInfo"></select-enemy>

                            <button ng-if="!ec.hideInfo" ng-click="ec.createSim()">Start simulation</button>
                        </section>

                        <section ng-controller="simulationController as sim">
                            <div ng-if="sim.questData.quest != undefined">
                                <h2>Simulate combat</h2>
                                <party-picker party="sim.party" quest="sim.questData.quest"></party-picker>
                                <div>
                                    <enemy-data data="sim.questData.quest"></enemy-data>
                                    <div class="animate-repeat" ng-repeat="hero in sim.heroes">
                                        <hr/>
                                        <span class="ico-heroes" ng-class="hero.icon"></span>
                                        <span class="v-align-super">{{hero.name}} - combat potential {{sim.calcPotential(hero) | number: 2}}</span>

                                    </div>
                                </div>
                                <button ng-click="sim.go()">Simulate</button>
                            </div>
                        </section>
                    </uib-tab>
                </uib-tabset>


            </article>

            <aside ng-controller="storageController as aside">
                <h3>Note</h3>
                <p>Alpha version. Not all features are implemented</p>
                <p>{{aside.statusText}}</p>
                <div ng-if="aside.isStorageAvailable">
                    <button ng-click="aside.saveSetup()">Save to local storage</button>
                    <button ng-click="aside.loadSetup()" ng-enabled="aside.loadActive">Load from local storage</button>
                </div>
            </aside>

        </div>
        <!-- #main -->
    </div>
    <!-- #main-container -->

    <div class="footer-container">
        <footer class="wrapper">
            <h3>v 0.1.2 - for merchant version 2.302</h3>
        </footer>
    </div>

    <script src="app.js"></script>
</body>

</html>